<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- <link rel="icon" href="../../../../favicon.ico"> -->

    <title>Group 25</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <style>
        .col-centered {
            margin: 0 auto;
            float: none;
        }
    </style>
    <link rel="stylesheet" href="css/atom-one-light.css">
  </head>

  <body>
    <div class="container" style="margin-top:25px;">
    <div class="row">
    <div class="col-md-10 col-centered">
        <nav style="margin-bottom: 25px;">
            <a href="index.html">Background and Motivation</a>
            &nbsp;|&nbsp;<a href="page_2.html">Introduction and EDA</a>
            &nbsp;|&nbsp;<a href="page_3.html">Literature Review and Related Work</a>
            &nbsp;|&nbsp;<span>Models</span>
            &nbsp;|&nbsp;<a href="page_5.html">Results and Conclusion</a>
        </nav>

      <h1>Models</h1>
      <p class="lead">The Development from a Baseline to the Final Ensemble Models</p>

      <hr>

      <h4>Contents</h4>
      <ol>
          <a href="#Baseline"><li>Baseline Models</li></a>
          <ol>
              <a href="#Base1"><li>Data Cleaning</li></a>
              <a href="#Base2"><li>Win/Loss/Draw: Classification</li></a>
              <a href="#Base3"><li>Goal Differential: Regression</li></a>
          </ol>

          <a href="#Improved"><li>Improved Models</li></a>
          <ol>
              <a href="#Imp1"><li>Additional Features</li></a>
                <ol>
                    <a href="#Imp1a"><li>Outline</li></a>
                    <a href="#Imp1b"><li>Data Cleaning</li></a>
                </ol>
              <a href="#Imp2"><li>Improved Win/Loss/Draw (RF and Features Added)</li></a>
              <a href="#Imp3"><li>Improved Goal Differential (RF and Features Added)</li></a>
          </ol>
          <a href="#Best"><li>Best Model</li></a>
      </ol>

      <hr>

      <h2 id="Baseline">Baseline Models</h2>

      <br/>

      <h4 id="Base1">Data Cleaning (Baseline)</h4>

      
      <img class="img-fluid" src="images/Clean1.png">
      <img class="img-fluid" src="images/Clean2.png">
      <p></p>
      <img class="img-fluid" src="images/Clean3.png">
      <p></p>
      <img class="img-fluid" src="images/Clean4.png">
      <img class="img-fluid" src="images/Clean5.png">
      <img class="img-fluid" src="images/Clean6.png">
      <img class="img-fluid" src="images/Clean7.png">
      
      <p></p>
      <h4 id="Base2">Win/Loss/Draw: Classification (Baseline)</h4>

      <img class="img-fluid" src="images/WLBase1.png">
      <img class="img-fluid" src="images/WLBase2.png">

      <p></p>

      <p></p>
      <h4 id="Base3">Goal Differential: Regression (Baseline)</h4>
      
      <img class="img-fluid" src="images/GDBase1.png">
      <img class="img-fluid" src="images/GdBase2.png">

      <p></p>

      <hr>

      <h2 id="Imp1">Additional Features</h2>
      
      <p></p>

      <img class="img-fluid" src="images/AddtlFeatures.png">

      <hr> 
      
      <br/>

      <h4 id="eda-2">1) Neutral Games vs Biased Games</h4>
      <p>The following piechart is simply to understand Kaggle's dataset better.</p>

      <p>Fig 6.</p>
      <img class="img-fluid" src="images/HomeWin1.png">
      <p></p>
      <p>The following map visualization is based on an adjusted dataframe with home advantage score calculated (function provided below).</p>
      <p></p>
      <p>Fig 7.</p>
      <img class="img-fluid" src="images/HomeAwayMain.png">

      <pre><code class="py">
def get_home_team_advantage(goals_df, pval=0.05):
    
    # extract relevant columns
    model_goals_df = goals_df[['HomeTeam','AwayTeam','FTHG','FTAG']]
    # rename goal columns
    model_goals_df = model_goals_df.rename(columns={'FTHG': 'HomeGoals', 'FTAG': 'AwayGoals'})

    # reformat dataframe for the model
    goal_model_data = pd.concat([model_goals_df[['HomeTeam','AwayTeam','HomeGoals']].assign(home=1).rename(
                columns={'HomeTeam':'team', 'AwayTeam':'opponent','HomeGoals':'goals'}),
               model_goals_df[['AwayTeam','HomeTeam','AwayGoals']].assign(home=0).rename(
                columns={'AwayTeam':'team', 'HomeTeam':'opponent','AwayGoals':'goals'})])

    # build poisson model
    poisson_model = smf.glm(formula="goals ~ home + team + opponent", data=goal_model_data, 
                            family=sm.families.Poisson()).fit()
    # output model parameters
    poisson_model.summary()
    
    return np.concatenate((np.array([poisson_model.params['home']]), 
                    poisson_model.conf_int(alpha=pval).values[-1]))
      </code></pre>
      
      <p></p>
      <h4 id="eda-2">2) Match Success by Venue</h4>
      <p>The following visualizations show the ratio of matches won by neutrality of venue.</p>

<!--       <p>Fig 8.</p>
      <img class="img-fluid" src="images/HomeWin4.png">
      <p></p> -->


      <p>Fig 8. and Fig 9.</p>
      <img class="img-fluid" src="images/HomeWin5.png">
      <p></p>
<!--       <p>Fig 11. and Fig 12.</p>
      <img class="img-fluid" src="images/HomeWin6.png">
      <p></p> -->

      <hr>

      <h2 id="eda-3">Population EDAs</h2>

      <br/>

      <h4 id="eda-3">1) Population vs Team/Player Quality</h4>
      <p>The following two graphs were to demonstrate the effect of population on team rank and player quality (overall score).</p>

      <p>Fig 10.</p>
      <img class="img-fluid" src="images/Pop1.png">
      <p></p>
      <p>Fig 11.</p>
      <img class="img-fluid" src="images/Pop2.png">

      <hr>

    </div> <!-- /col-md-10 -->
    </div> <!-- /row -->
    </div> <!-- /container -->
  </body>
</html>
